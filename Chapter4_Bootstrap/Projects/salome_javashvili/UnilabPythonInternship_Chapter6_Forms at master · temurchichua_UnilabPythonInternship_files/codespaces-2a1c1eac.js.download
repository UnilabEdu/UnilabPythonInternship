System.register(["./chunk-vendor.js","./chunk-frameworks.js"],(function(){"use strict";var t,e,o,s,r,i,n,a,c,d,l;return{setters:[function(n){t=n.r,e=n.o,o=n._,s=n.t,r=n.c,i=n.a},function(t){n=t.r,a=t.aF,c=t.aG,d=t.t,l=t.c}],execute:function(){t(".js-new-codespace-form",(async function(t,e){const o=t.closest("[data-replace-remote-form-target]"),s=o.querySelector(".js-new-codespace-submit-button");s instanceof HTMLInputElement&&(s.disabled=!0),t.classList.remove("is-error"),t.classList.add("is-loading");try{const t=await e.html();o.replaceWith(t.html)}catch(r){t.classList.remove("is-loading"),t.classList.add("is-error")}}));let h=null;function u(t){if(h=t,null!==t){document.querySelector(".js-codespace-loading-steps").setAttribute("data-current-state",h)}}e(".js-codespace-loading-steps",{constructor:HTMLElement,add:t=>{const e=t.getAttribute("data-current-state");e&&u(e)}}),e(".js-codespace-advance-state",{constructor:HTMLElement,add:t=>{const e=t.getAttribute("data-state");e&&u(e)}});let p=null;function m(t){const e=document.querySelector(".js-workbench-form-container form");e&&t?(!function(t,e){const o=t.querySelector(".js-cascade-token");o&&o.setAttribute("value",e)}(e,t),function(t,e){const o=t.querySelector(".js-partner-info");if(o){let t=o.getAttribute("value");t&&(t=t.replace("%CASCADE_TOKEN_PLACEHOLDER%",e),o.setAttribute("value",t))}}(e,t),n(e)):u("failed")}e(".js-auto-submit-form",{constructor:HTMLFormElement,initialize:n}),e(".js-workbench-form-container",{constructor:HTMLElement,add:e=>{const o=e.querySelector(".js-cascade-token");!function(t){if(t)try{fetch(t.action,{method:t.method,body:new FormData(t)})}catch(e){}}(document.querySelector(".js-start-codespace")),function(e,o){if(""!==o.value){const t=e.querySelector("form");n(t)}else{!function(e){t(".js-fetch-cascade-token",(async function(t,e){try{const t=(await e.json()).json;p=t.token}catch(o){}})),n(e)}(document.querySelector(".js-fetch-cascade-token")),function(t,e,o){if(document.querySelector(t)){const t=Date.now(),s=setInterval((()=>{const r=Date.now()-t;if(p||r>=o)return clearInterval(s),void e(p||void 0)}),50)}}(".js-workbench-form-container",m,1e4)}}(e,o)}});let f=class NewCodespaceElement extends HTMLElement{async connectedCallback(){if(this.createCodespaceForm){const t=await a(this.createCodespaceForm,!this.vscsLocationList);this.updatePickableLocations(t)}}async updatePickableLocations(t){if(!t){const e=this.createCodespaceForm.getAttribute("data-codespace-locations-url");if(!e)return;t=await c(e)}const e=t.available;if(this.vscsLocationList){const o=this.vscsLocationList.querySelectorAll(".SelectMenu-item");for(const t of o)e.includes(t.getAttribute("data-location"))?t.removeAttribute("hidden"):t.setAttribute("hidden","hidden");const s=this.createCodespaceForm.querySelector('[name="codespace[location]"]');if(s&&!e.includes(s.value)){s.value=t.current,this.vscsLocationSummary.textContent=this.vscsLocationSummary.getAttribute("data-blank-title");for(const t of o)t.setAttribute("aria-checked","false")}}}vscsTargetUrlUpdated(t){const e=t.currentTarget;this.vscsTargetUrl.value=e.value}};function y(t){const e=t.querySelectorAll(".js-toggle-hidden");for(const s of e)s.hidden=!s.hidden;const o=t.querySelectorAll(".js-toggle-disabled");for(const s of o)s.getAttribute("aria-disabled")?s.removeAttribute("aria-disabled"):s.setAttribute("aria-disabled","true")}o([s],f.prototype,"form",void 0),o([s],f.prototype,"createCodespaceForm",void 0),o([s],f.prototype,"vscsTargetUrl",void 0),o([s],f.prototype,"vscsLocationList",void 0),o([s],f.prototype,"vscsLocationSummary",void 0),f=o([r],f),i("submit",".js-toggle-hidden-codespace-form",(function(t){y(t.currentTarget)})),i("click",".js-create-codespace-with-sku-button",(async function(t){const e=t.currentTarget.closest("[data-target='new-codespace.createCodespaceForm']");await a(e),y(e),e.submit()})),i("submit","form.js-codespaces-delete-form",(async function(t){t.preventDefault();const e=t.currentTarget;try{const t=await fetch(e.action,{method:e.method,body:new FormData(e),headers:{Accept:"text/fragment+html","X-Requested-With":"XMLHttpRequest"}});if(t.ok){const o=d(document,await t.text());(function(t){return t.closest("[data-replace-remote-form-target]")})(e).replaceWith(o)}else{if(401!==t.status)throw new Error("Unexpected response: "+t.statusText);e.submit()}}finally{y(e)}})),i("submit","form.js-open-in-vscode-form",(async function(t){t.preventDefault();const e=t.currentTarget,o=await fetch(e.action,{method:e.method,body:new FormData(e),headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(o.ok){const t=await o.json();window.location.href=t.codespace_url}else if(422===o.status){const t=await o.json(),s=e.querySelector(".js-open-in-vscode-error");s&&(s.insertAdjacentHTML("afterbegin",t.error),s.hidden=!1)}}));let g=class EditorSelectElement extends HTMLElement{async createCodespace(t){const e=t.currentTarget;t.preventDefault(),await a(e);let o=null;const s=new FormData(e);if("true"===s.get("open_in_vscode"))try{if(o=await fetch(e.action,{method:e.method,body:s,headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),o.ok){const t=await o.json();"true"===s.get("open_in_vscode")&&this.showPostLaunch(),window.location.href=t.codespace_url}else if(401===o.status)e.submit();else if(422===o.status){const t=await o.json();this.showCreateError(t.error)}else this.showCreateError()}catch(r){return}finally{this.button.hidden=!1,this.disabledButton.hidden=!0,this.checkbox.hidden=!1}else e.submit()}hideCheckbox(){this.checkbox.hidden=!0}showPostLaunch(){this.form.hidden=!0,this.postLaunch.hidden=!1,this.createError.hidden=!0,y(this.form)}showCreateError(t){this.form.hidden=!0,this.postLaunch.hidden=!0,this.createError.hidden=!1,t?(this.createErrorMessage.textContent=t,this.createErrorMessage.hidden=!1,this.defaultCreateErrorMessage.hidden=!0):(this.createErrorMessage.hidden=!0,this.defaultCreateErrorMessage.hidden=!1)}};o([s],g.prototype,"form",void 0),o([s],g.prototype,"postLaunch",void 0),o([s],g.prototype,"createError",void 0),o([s],g.prototype,"createErrorMessage",void 0),o([s],g.prototype,"defaultCreateErrorMessage",void 0),o([s],g.prototype,"button",void 0),o([s],g.prototype,"disabledButton",void 0),o([s],g.prototype,"checkbox",void 0),g=o([r],g);let v=class ExportBranchElement extends HTMLElement{constructor(){super(...arguments),this.abortPoll=null}connectedCallback(){this.abortPoll=new AbortController,this.loadingIndicator.hidden||this.startPoll()}disconnectedCallback(){var t;null===(t=this.abortPoll)||void 0===t||t.abort()}async exportBranch(t){t.preventDefault(),this.form.hidden=!0,this.loadingIndicator.hidden=!1;(await fetch(this.form.action,{method:this.form.method,body:new FormData(this.form),headers:{Accept:"text/fragment+html","X-Requested-With":"XMLHttpRequest"}})).ok?this.startPoll():(this.form.hidden=!1,this.loadingIndicator.hidden=!0)}async startPoll(){const t=this.getAttribute("data-exported-codespace-url")||"",e=await this.poll(t);if(e)if(e.ok)this.loadingIndicator.hidden=!0,this.viewBranchLink.hidden=!1;else{const t=this.getAttribute("data-export-error-redirect-url")||"";window.location.href=t}}async poll(t,e=1e3){var o,s;if(null===(o=this.abortPoll)||void 0===o?void 0:o.signal.aborted)return;const r=await fetch(t,{signal:null===(s=this.abortPoll)||void 0===s?void 0:s.signal});return 202===r.status?(await new Promise((t=>setTimeout(t,e))),this.poll(t,1.5*e)):r}};o([s],v.prototype,"form",void 0),o([s],v.prototype,"loadingIndicator",void 0),o([s],v.prototype,"viewBranchLink",void 0),v=o([r],v);let b=class OptionsPopoverElement extends HTMLElement{reset(t){for(t.preventDefault(),this.dropdownDetails.hidden=!1,this.modalDetails.hidden=!0,this.exportDetails.hidden=!0,this.skuForm.hidden=!1;this.resultMessage.firstChild;)this.resultMessage.removeChild(this.resultMessage.firstChild);this.resultMessage.hidden=!0,this.errorMessage.hidden=!0}showSettingsModal(){this.dropdownDetails.hidden=!0,this.modalDetails.open=!0,this.modalDetails.hidden=!1}showExportModal(){this.dropdownDetails.hidden=!0,this.exportDetails.open=!0,this.exportDetails.hidden=!1,this.insertBranchExportComponent()}async updateSku(){y(this.skuForm);try{const t=await fetch(this.skuForm.action,{method:this.skuForm.method,body:new FormData(this.skuForm),headers:{Accept:"text/fragment+html","X-Requested-With":"XMLHttpRequest"}});if(t.ok){const e=d(document,await t.text());this.resultMessage.appendChild(e),this.skuForm.hidden=!0,this.resultMessage.hidden=!1}else this.errorMessage.hidden=!1,this.skuForm.hidden=!0}finally{y(this.skuForm)}}async insertBranchExportComponent(){const t=this.querySelector("[data-branch-export-url]");if(!t)return;const e=t.getAttribute("data-branch-export-url");if(!e)return;const o=await l(document,e);o&&(t.innerHTML="",t.appendChild(o))}};o([s],b.prototype,"dropdownDetails",void 0),o([s],b.prototype,"modalDetails",void 0),o([s],b.prototype,"settingsModal",void 0),o([s],b.prototype,"skuForm",void 0),o([s],b.prototype,"resultMessage",void 0),o([s],b.prototype,"errorMessage",void 0),o([s],b.prototype,"exportDetails",void 0),b=o([r],b);let w=class PrefetchPaneElement extends HTMLElement{constructor(){super(...arguments),this.prefetching=!1,this.remainingRetries=3}async prefetchLocationAndSkus(){if(this.prefetching)return;const t=document.querySelector("form.js-prefetch-codespace-location")||document.querySelector("form.js-open-in-vscode-form")||document.querySelector("form.js-open-in-web-form")||document.querySelector('[data-target="editor-select.form"]');if(t){this.prefetching=!0;const e=await a(t);if(e&&(this.currentLocation=e.current),!this.skuSelect)return;const o=this.skuSelect.getAttribute("data-codespace-skus-url");if(this.currentLocation&&o){const t=await fetch(`${o}&location=${this.currentLocation}`,{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/html_fragment"}});if(t.ok){const e=d(document,await t.text());this.skuSelect.replaceWith(e),this.skuSelect.hidden=!1,this.skuError&&(this.skuError.hidden=!0)}else this.remainingRetries-=1,this.remainingRetries>0&&(this.prefetching=!1),this.skuSelect.hidden=!0,this.skuError&&(this.skuError.hidden=!1)}}}};o([s],w.prototype,"skuSelect",void 0),o([s],w.prototype,"skuError",void 0),w=o([r],w)}}}));
//# sourceMappingURL=codespaces-a04fa978.js.map
